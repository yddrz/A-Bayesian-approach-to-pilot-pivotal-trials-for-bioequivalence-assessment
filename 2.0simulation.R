#SIMULATION
setwd("/data/Workdir_zhu/Dora")

simfun<-function(seed,N,sample1,uT,uR,q,p,sij,eijk) {
  set.seed(seed)
  list1=list()
  for (i in 1:N){
    my.df1 <- data.frame(Subject=rep(1:sample1), 
                         seq=rep(1:2,each=sample1/2), 
                         period=rep(1:2,sample1/2), form=2)
    my.df1$distance <- uR + (-1)^my.df1$seq*q+(-1)^my.df1$period*p + rnorm(sample1,0,sij)+ rnorm(sample1,0,eijk)
    my.df2 <- data.frame(Subject=rep(1:sample1), 
                         seq=rep(1:2,each=sample1/2), 
                         period=rep(1:2,sample1/2), form=1)
    my.df2$distance <- uT + (-1)^my.df1$seq*q+(-1)^my.df2$period*p + rnorm(sample1,0,sij)+ rnorm(sample1,0,eijk)
    my.df<-rbind(my.df1,my.df2)
    list1[[i]]=my.df}
  list1
}
cmax<-simfun(20,10000,12,8.349,8.187,0.016,0.025,0.088,0.237)
auct<-simfun(20,10000,12,9.231,9.163,0.048,0.026,0.101,0.122)
aucall<-simfun(20,10000,12,9.287,9.219,0.051,0.024,0.099,0.119)

cmax1<-simfun(28,10000,12,7.494,8.187,0.016,0.025,0.088,0.237)
auct1<-simfun(28,10000,12,8.470,9.163,0.048,0.026,0.101,0.122)
aucall1<-simfun(28,10000,12,8.526,9.219,0.051,0.024,0.099,0.119)

cmaxp1<-simfun(208,10000,24,7.494,8.187,0.016,0.025,0.088,0.237)
auctp1<-simfun(208,10000,24,8.470,9.163,0.048,0.026,0.101,0.122)
aucallp1<-simfun(208,10000,24,8.526,9.219,0.051,0.024,0.099,0.119)

cmax2<-simfun(26,10000,12,7.830,8.187,0.016,0.025,0.088,0.237)
auct2<-simfun(26,10000,12,8.806,9.163,0.048,0.026,0.101,0.122)
aucall2<-simfun(26,10000,12,8.862,9.219,0.051,0.024,0.099,0.119)

cmaxp2<-simfun(206,10000,24,7.830,8.187,0.016,0.025,0.088,0.237)
auctp2<-simfun(206,10000,24,8.806,9.163,0.048,0.026,0.101,0.122)
aucallp2<-simfun(206,10000,24,8.862,9.219,0.051,0.024,0.099,0.119)

cmax3<-simfun(22,10000,12,7.964,8.187,0.016,0.025,0.088,0.237)
auct3<-simfun(22,10000,12,8.940,9.163,0.048,0.026,0.101,0.122)
aucall3<-simfun(22,10000,12,8.996,9.219,0.051,0.024,0.099,0.119)

cmaxp3<-simfun(202,10000,24,7.964,8.187,0.016,0.025,0.088,0.237)
auctp3<-simfun(202,10000,24,8.940,9.163,0.048,0.026,0.101,0.122)
aucallp3<-simfun(202,10000,24,8.996,9.219,0.051,0.024,0.099,0.119)

cmax4<-simfun(24,10000,12,8.082,8.187,0.016,0.025,0.088,0.237)
auct4<-simfun(24,10000,12,9.058,9.163,0.048,0.026,0.101,0.122)
aucall4<-simfun(24,10000,12,9.114,9.219,0.051,0.024,0.099,0.119)

cmaxp4<-simfun(204,10000,24,8.082,8.187,0.016,0.025,0.088,0.237)
auctp4<-simfun(204,10000,24,9.058,9.163,0.048,0.026,0.101,0.122)
aucallp4<-simfun(204,10000,24,9.114,9.219,0.051,0.024,0.099,0.119)

cmax5<-simfun(21,10000,12,8.187,8.187,0.016,0.025,0.088,0.237)
auct5<-simfun(21,10000,12,9.163,9.163,0.048,0.026,0.101,0.122)
aucall5<-simfun(21,10000,12,9.219,9.219,0.051,0.024,0.099,0.119)

cmaxp5<-simfun(201,10000,24,8.187,8.187,0.016,0.025,0.088,0.237)
auctp5<-simfun(201,10000,24,9.163,9.163,0.048,0.026,0.101,0.122)
aucallp5<-simfun(201,10000,24,9.219,9.219,0.051,0.024,0.099,0.119)

cmax6<-simfun(25,10000,12,8.282,8.187,0.016,0.025,0.088,0.237)
auct6<-simfun(25,10000,12,9.258,9.163,0.048,0.026,0.101,0.122)
aucall6<-simfun(25,10000,12,9.314,9.219,0.051,0.024,0.099,0.119)

cmaxp6<-simfun(205,10000,24,8.282,8.187,0.016,0.025,0.088,0.237)
auctp6<-simfun(205,10000,24,9.258,9.163,0.048,0.026,0.101,0.122)
aucallp6<-simfun(205,10000,24,9.314,9.219,0.051,0.024,0.099,0.119)

cmax7<-simfun(23,10000,12,8.410,8.187,0.016,0.025,0.088,0.237)
auct7<-simfun(23,10000,12,9.386,9.163,0.048,0.026,0.101,0.122)
aucall7<-simfun(23,10000,12,9.442,9.219,0.051,0.024,0.099,0.119)

cmaxp7<-simfun(203,10000,24,8.410,8.187,0.016,0.025,0.088,0.237)
auctp7<-simfun(203,10000,24,9.386,9.163,0.048,0.026,0.101,0.122)
aucallp7<-simfun(203,10000,24,9.442,9.219,0.051,0.024,0.099,0.119)

cmax8<-simfun(27,10000,12,8.545,8.187,0.016,0.025,0.088,0.237)
auct8<-simfun(27,10000,12,9.521,9.163,0.048,0.026,0.101,0.122)
aucall8<-simfun(27,10000,12,9.577,9.219,0.051,0.024,0.099,0.119)

cmaxp8<-simfun(207,10000,24,8.545,8.187,0.016,0.025,0.088,0.237)
auctp8<-simfun(207,10000,24,9.521,9.163,0.048,0.026,0.101,0.122)
aucallp8<-simfun(207,10000,24,9.577,9.219,0.051,0.024,0.099,0.119)

cmax9<-simfun(29,10000,12,8.880,8.187,0.016,0.025,0.088,0.237)
auct9<-simfun(29,10000,12,9.856,9.163,0.048,0.026,0.101,0.122)
aucall9<-simfun(29,10000,12,9.912,9.219,0.051,0.024,0.099,0.119)

cmaxp9<-simfun(209,10000,24,8.880,8.187,0.016,0.025,0.088,0.237)
auctp9<-simfun(209,10000,24,9.856,9.163,0.048,0.026,0.101,0.122)
aucallp9<-simfun(209,10000,24,9.912,9.219,0.051,0.024,0.099,0.119)